import{ae as S,d as W,S as I,W as v,a as D,l as h,h as P,i as A,af as C,ag as L,s as G}from"./three.module-CQU0seT4.js";/* empty css               */import{g as H}from"./lil-gui.module.min-Vka56b52.js";import{O as N,T as z}from"./TilesRenderer-Dt06WWnf.js";import{D as V}from"./DebugTilesPlugin-CJlX0XLV.js";import{E as U}from"./EnvironmentControls-CLbQ_1-I.js";import"./I3DMLoader--guqwtSo.js";import"./readMagicBytes-ReGFEf36.js";import"./GLTFLoader-Bzr6GmPM.js";import"./Ellipsoid-BKsGN9dG.js";import"./B3DMLoader-BZtrZCNg.js";import"./PNTSLoader-gB5YPyhc.js";import"./CMPTLoader-VEto4VOC.js";import"./EllipsoidRegion-BEIhCuST.js";import"./EllipsoidRegionHelper-4krpge1Q.js";class k{constructor(){this.name="LOAD_REGION_PLUGIN",this.regions=[],this.tiles=null}init(e){this.tiles=e}addRegion(e){this.regions.indexOf(e)===-1&&this.regions.push(e)}removeRegion(e){const o=this.regions.indexOf(e);o!==-1&&this.regions.splice(o,1)}hasRegion(e){return this.regions.indexOf(e)!==-1}clearRegions(){this.regions=[]}calculateTileViewError(e,o){const M=e.cached.boundingVolume,{regions:O,tiles:f}=this;let E=!1,w=-1/0;for(const B of O)B.intersectsTile(M,e,f)&&(E=!0,w=Math.max(B.calculateError(e,f),w));o.inView=E,o.error=w}dispose(){this.regions=[]}}class b{constructor(e=10){this.errorTarget=e}intersectsTile(){}calculateError(e,o){return e.geometricError-this.errorTarget+o.errorTarget}}class F extends b{constructor(e=10,o=new W){super(e),this.sphere=o.clone()}intersectsTile(e){return e.intersectsSphere(this.sphere)}}class X extends b{constructor(e=10,o=new S){super(e),this.ray=o.clone()}intersectsTile(e){return e.intersectsRay(this.ray)}}class Y extends b{constructor(e=10,o=new N){super(e),this.obb=o.clone(),this.obb.update()}intersectsTile(e){return e.intersectsOBB(this.obb)}}let n,R,l,s,i,u,m,d,c,g,a,y,p=0;const t={animate:!0,region:"SPHERE",regionErrorTarget:.1,regionOnly:!0,displayBoxBounds:!1};j();_();function j(){l=new I,s=new v({antialias:!0}),s.setPixelRatio(window.devicePixelRatio),s.setSize(window.innerWidth,window.innerHeight),s.setClearColor(1383455),document.body.appendChild(s.domElement),s.domElement.tabIndex=1,n=new D(60,window.innerWidth/window.innerHeight,1,1e5),n.position.set(100,100,100),n.lookAt(0,0,0),l.add(n),y=new G,i=new z("https://raw.githubusercontent.com/NASA-AMMOS/3DTilesSampleData/master/msl-dingo-gap/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize_tileset.json"),i.registerPlugin(new V),i.registerPlugin(new k),i.group.rotation.x=Math.PI/2,l.add(i.group),R=new U(i.group,n,s.domElement),R.enableDamping=!0,u=new X,m=new F,m.sphere.radius=15,d=new Y,d.obb.box.min=new h(-50,-50,-5),d.obb.box.max=new h(50,50,5),c=new P(new A),c.material.transparent=!0,c.material.opacity=.25,a=new P(new C),a.material.transparent=!0,a.material.opacity=.25,g=new L,g.geometry.setFromPoints([new h,new h(0,-1e3,0)]),g.material.opacity=.5,g.material.transparent=!0,T(t.region),x(),window.addEventListener("resize",x,!1);const r=new H;r.width=300,r.add(t,"region",["SPHERE","BOX","RAY"]).onChange(T),r.add(t,"regionErrorTarget").min(0).max(1),r.add(t,"animate"),r.add(t,"regionOnly").onChange(e=>{e?i.deleteCamera(n):(i.setCamera(n),x())}),r.add(t,"displayBoxBounds"),r.open()}function x(){n.aspect=window.innerWidth/window.innerHeight,s.setSize(window.innerWidth,window.innerHeight),n.updateProjectionMatrix(),s.setPixelRatio(window.devicePixelRatio*1),i.setResolutionFromRenderer(n,s)}function T(r){const e=i.getPluginByName("LOAD_REGION_PLUGIN");e.clearRegions(),l.remove(g,c,a),r==="SPHERE"?(e.addRegion(m),l.add(c)):r==="RAY"?(e.addRegion(u),l.add(g)):r==="BOX"&&(e.addRegion(d),l.add(a))}function _(){requestAnimationFrame(_),t.animate?p+=y.getDelta():y.getDelta();const r=i.getPluginByName("DEBUG_TILES_PLUGIN");r.enabled=t.displayBoxBounds,r.displayBoxBounds=t.displayBoxBounds,t.region==="SPHERE"?(c.position.set(Math.sin(p)*20,0,Math.cos(p)*20),c.scale.setScalar(m.sphere.radius),m.errorTarget=t.regionErrorTarget,m.sphere.center.copy(c.position).applyMatrix4(i.group.matrixWorldInverse)):t.region==="RAY"?(g.position.set(Math.sin(p*2)*20,50,Math.cos(p*2)*20),u.errorTarget=t.regionErrorTarget,u.ray.direction.set(0,-1,0).transformDirection(i.group.matrixWorldInverse),u.ray.origin.copy(g.position).applyMatrix4(i.group.matrixWorldInverse)):t.region==="BOX"&&(a.scale.set(50,10,50),a.rotation.y=p,a.updateMatrixWorld(),a.geometry.computeBoundingBox(),d.errorTarget=t.regionErrorTarget,d.obb.box.copy(a.geometry.boundingBox),d.obb.transform.copy(a.matrixWorld).premultiply(i.group.matrixWorldInverse),d.obb.update()),R.update(),n.updateMatrixWorld(),i.update(),s.render(l,n)}
//# sourceMappingURL=loadRegion-DZFeH_ch.js.map
