import{S as M,W as R,P,a as y,O as v,D as T,A as W,B as A,d as L,G as D,e as E}from"./three.module-CQU0seT4.js";/* empty css               */import{O}from"./OrbitControls-CAmelIij.js";import{g as z}from"./lil-gui.module.min-Vka56b52.js";import{S as B}from"./stats.module--VATS4Kh.js";import{T as H}from"./TilesRenderer-Dt06WWnf.js";import"./I3DMLoader--guqwtSo.js";import"./readMagicBytes-ReGFEf36.js";import"./GLTFLoader-Bzr6GmPM.js";import"./Ellipsoid-BKsGN9dG.js";import"./B3DMLoader-BZtrZCNg.js";import"./PNTSLoader-gB5YPyhc.js";import"./CMPTLoader-VEto4VOC.js";import"./EllipsoidRegion-BEIhCuST.js";let a,p,m,i,e,t,d,c,h,r,w;const u=0,g=1,S=2,s={errorTarget:2,shadowStrategy:u,orthographic:!1};I();x();function F({scene:o}){o.traverse(n=>{n.isMesh&&(n.material=new E,n.castShadow=!0,n.receiveShadow=!0)})}function j(o){o.traverse(n=>{n.isMesh&&n.material.dispose()})}function I(){m=new M,i=new R({antialias:!0}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.setClearColor(1383455),i.shadowMap.enabled=!0,i.shadowMap.type=P,document.body.appendChild(i.domElement),a=new y(60,window.innerWidth/window.innerHeight,1,4e3),a.position.set(-56,232,260),t=new v,p=new O(a,i.domElement),p.screenSpacePanning=!1,p.minDistance=1,p.maxDistance=2e3,r=new T(16777215,1.25),r.position.set(-100,40,10),r.castShadow=!0,r.shadow.bias=-1e-4,r.shadow.normalBias=.2,r.shadow.mapSize.setScalar(2048);const o=r.shadow.camera;o.left=-120,o.bottom=-120,o.right=120,o.top=120,o.updateProjectionMatrix(),m.add(r);const n=new W(16777215,.05);m.add(n),c=new A,h=new L,d=new D,m.add(d);const b=window.location.hash.replace(/^#/,"")||"../data/tileset.json";e=new H(b),e.addEventListener("load-model",F),e.addEventListener("dispose-model",j),d.add(e.group),f(),window.addEventListener("resize",f,!1);const l=new z;l.width=300,l.add(s,"orthographic"),l.add(s,"errorTarget").min(0).max(25).step(1),l.add(s,"shadowStrategy",{NONE:u,DISPLAY_ACTIVE_TILES:g,USE_SHADOW_CAMERA:S}),l.open(),w=new B,w.showPanel(0),document.body.appendChild(w.dom)}function f(){a.aspect=window.innerWidth/window.innerHeight,i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),a.updateProjectionMatrix(),C()}function C(){t.position.copy(a.position),t.rotation.copy(a.rotation);const o=a.position.distanceTo(p.target)/2,n=window.innerWidth/window.innerHeight;t.left=-n*o,t.right=n*o,t.bottom=-o,t.top=o,t.near=a.near,t.far=a.far,t.updateProjectionMatrix()}function x(){switch(requestAnimationFrame(x),e.errorTarget=s.errorTarget,parseFloat(s.shadowStrategy)){case u:e.displayActiveTiles=!1,e.autoDisableRendererCulling=!0,e.deleteCamera(r.shadow.camera);break;case g:e.displayActiveTiles=!0,e.autoDisableRendererCulling=!1,e.deleteCamera(r.shadow.camera);break;case S:e.displayActiveTiles=!1,e.autoDisableRendererCulling=!1,e.setCamera(r.shadow.camera),e.setResolution(r.shadow.camera,r.shadow.mapSize);break}s.orthographic?(e.deleteCamera(a),e.setCamera(t),e.setResolutionFromRenderer(t,i)):(e.deleteCamera(t),e.setCamera(a),e.setResolutionFromRenderer(a,i)),d.rotation.set(0,0,0),s.up==="-Z"&&(d.rotation.x=Math.PI/2),d.updateMatrixWorld(!0),e.getBoundingBox(c)?(c.getCenter(e.group.position),e.group.position.multiplyScalar(-1)):e.getBoundingSphere(h)&&(e.group.position.copy(h.center),e.group.position.multiplyScalar(-1)),window.tiles=e,a.updateMatrixWorld(),t.updateMatrixWorld(),e.update(),_(),w.update()}function _(){C(),i.render(m,s.orthographic?t:a)}
//# sourceMappingURL=offscreenShadows-B7P7qHgp.js.map
