import{l as T,M as C}from"./three.module-CQU0seT4.js";import{u as w,r as g,d as A,j as e,c as R,C as G,T as O,b as _,E as X}from"./CameraControls-BTa4S6yL.js";import{T as z}from"./TopoLinesPlugin-CY-r0AnE.js";import{C as N}from"./CanvasDOMOverlay-DhqylH3l.js";import{T as $}from"./TilesFadePlugin-D_u_P2Qt.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./EnvironmentControls-CLbQ_1-I.js";import"./GlobeControls-CKSk7BfI.js";import"./Ellipsoid-BKsGN9dG.js";import"./I3DMLoader--guqwtSo.js";import"./readMagicBytes-ReGFEf36.js";import"./GLTFLoader-Bzr6GmPM.js";import"./TilesRenderer-Dt06WWnf.js";import"./B3DMLoader-BZtrZCNg.js";import"./PNTSLoader-gB5YPyhc.js";import"./CMPTLoader-VEto4VOC.js";import"./EllipsoidRegion-BEIhCuST.js";const F=new T,W=new T;function B(o,r,i){const l=F.set(0,0,-i).applyMatrix4(o.projectionMatrix),u=W.set(.01,0,-i).applyMatrix4(o.projectionMatrix);return 1/(Math.abs(l.x-u.x)*r.width*.5/.01)}function m(o){if(o===null)return"--";const r=U(o);return`${parseFloat(r.value.toFixed(2)).toString().replace(/^-/,"- ")}${r.unit}`}function U(o){const r=Math.ceil(Math.log10(Math.abs(o)));let i="m",s=0;switch(C.clamp(r,-6,2)){case 2:i="km",s=3;break;case 1:case 0:case-1:i="m",s=0;break;case-2:i="cm",s=-2;break;case-3:case-4:case-5:i="mm",s=-3;break;case-6:i="Î¼M",s=-6;break;default:throw new Error}return{unit:i,value:o*Math.pow(10,-s)}}function V({invert:o}){const r=w(({get:t})=>t),i=w(({gl:t})=>t),s=w(({pointer:t})=>t),[l,u]=g.useState(null),h=g.useContext(A),p=i.domElement;g.useEffect(()=>{const t=()=>{const n=h&&h.getPluginByName("TOPO_LINES_PLUGIN");if(n){const{pointer:x,camera:c,scene:j,raycaster:b}=r();b.setFromCamera(x,c);const y=b.intersectObject(j)[0];if(y){const E=n.computeTopographicLineInfo(c,y.point),S={metersPerPixel:B(c,n.resolution,y.distance)};o&&(E.value*=-1),u({elevation:E,length:S})}else u(null)}};return p.addEventListener("pointermove",t),p.addEventListener("wheel",t),()=>{p.removeEventListener("pointermove",t),p.removeEventListener("wheel",t)}},[r,p,h,o]);let f=null,M=5,v=null,a=0,d=null;if(l){const t=window.devicePixelRatio,n=l.elevation.alpha<.25?l.elevation.max:l.elevation.min;f=l.elevation.value,M=n.stepInPixels/t,v=n.step;const x=50,c=l.length.metersPerPixel*t,j=x*c;d=10**Math.floor(Math.log10(j)),a=d/c,a*5<x&&(d*=5,a*=5),a*2.5<x&&(d*=2.5,a*=2.5)}const P=e.jsx("div",{style:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden",alignItems:"end",justifyContent:"end",paddingBottom:"0.5em"},children:new Array(10).fill().map((t,n)=>e.jsx("div",{style:{minHeight:"1px",opacity:n===9?1:.5,width:n===9?"15px":"10px",background:"white",marginTop:M}},n))}),L=e.jsxs("div",{style:{display:"flex",overflow:"hidden",flexGrow:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"end"},children:[e.jsx("div",{children:m(v)}),e.jsx("div",{children:m(v*10||null)})]}),P]}),D=e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx("div",{style:{flexGrow:1},children:m(d)}),e.jsx("div",{children:"len"})]}),e.jsx("div",{style:{height:"2px",borderTop:"1px solid white",borderLeft:"1px solid white",borderRight:"1px solid white",width:a===0?"100%":`${a}px`}})]}),I=e.jsxs("div",{style:{display:"flex",marginTop:"10px"},children:[e.jsx("div",{style:{flexGrow:1},children:m(f)}),e.jsx("div",{children:"el"})]}),k=e.jsx("div",{style:{position:"absolute",left:`${(s.x*.5+.5)*100}%`,top:`${100-(s.y*.5+.5)*100}%`,color:"white",fontSize:"12px",pointerEvents:"none",textShadow:"0px 0px 4px rgba( 0, 0, 0, 0.5 )"},children:e.jsx("div",{style:{transform:"translateX( -50% ) translateY( -125% )"},children:f?m(f):""})});return e.jsxs(N,{children:[k,e.jsxs("div",{style:{padding:"5px",width:"65px",height:"80px",position:"absolute",left:5,bottom:5,background:"rgb( 0, 0, 0, 0.2 )",borderRadius:3,color:"white",display:"flex",flexDirection:"column",fontSize:"12px"},children:[L,I,D]})]})}const H="https://raw.githubusercontent.com/NASA-AMMOS/3DTilesSampleData/master/msl-dingo-gap/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize_tileset.json";function Y(){return e.jsxs(G,{camera:{position:[12,7.5,12]},style:{width:"100%",height:"100%",position:"absolute",margin:0,left:0,top:0},children:[e.jsx("color",{attach:"background",args:[2236962]}),e.jsx("group",{"rotation-x":Math.PI/2,children:e.jsxs(O,{url:H,children:[e.jsx(_,{plugin:$}),e.jsx(_,{plugin:z,args:{topoLimit:[.01,1e10]}}),e.jsx(V,{invert:!0})]})}),e.jsx(X,{enableDamping:!0,maxDistance:500,minDistance:1,cameraRadius:.5})]})}R.createRoot(document.getElementById("root")).render(e.jsx(g.StrictMode,{children:e.jsx(Y,{})}));
//# sourceMappingURL=topo-O9j8vBBF.js.map
